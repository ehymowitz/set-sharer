{"ast":null,"code":"import jwt from 'jsonwebtoken';\nimport { PrismaClient } from \"@prisma/client\";\nconst prisma = new PrismaClient();\nexport default (async (req, res) => {\n  const {\n    token\n  } = req.cookies;\n  console.log({\n    token\n  });\n\n  if (token) {\n    const {\n      id,\n      setName\n    } = jwt.verify(token, process.env.JWT_SECRET);\n    const songs = await prisma.song.findMany({\n      where: {\n        setId: id\n      }\n    });\n    console.log(songs);\n\n    if (songs) {\n      res.json(songs);\n    } else {\n      res.json({});\n    }\n  } else {\n    res.json({});\n  }\n});","map":{"version":3,"sources":["/Users/elie/code/ehymowitz/set-sharer/pages/api/songs.ts"],"names":["jwt","PrismaClient","prisma","req","res","token","cookies","console","log","id","setName","verify","process","env","JWT_SECRET","songs","song","findMany","where","setId","json"],"mappings":"AAAA,OAAOA,GAAP,MAAgB,cAAhB;AACA,SAASC,YAAT,QAA6B,gBAA7B;AACA,MAAMC,MAAM,GAAG,IAAID,YAAJ,EAAf;AAEA,gBAAe,OAAOE,GAAP,EAAYC,GAAZ,KAAoB;AACjC,QAAM;AAAEC,IAAAA;AAAF,MAAYF,GAAG,CAACG,OAAtB;AAEAC,EAAAA,OAAO,CAACC,GAAR,CAAY;AAACH,IAAAA;AAAD,GAAZ;;AAEA,MAAIA,KAAJ,EAAY;AACV,UAAM;AAAEI,MAAAA,EAAF;AAAMC,MAAAA;AAAN,QAAkBV,GAAG,CAACW,MAAJ,CAAWN,KAAX,EAAkBO,OAAO,CAACC,GAAR,CAAYC,UAA9B,CAAxB;AACA,UAAMC,KAAK,GAAG,MAAMb,MAAM,CAACc,IAAP,CAAYC,QAAZ,CAAqB;AACvCC,MAAAA,KAAK,EAAE;AAAEC,QAAAA,KAAK,EAAEV;AAAT;AADgC,KAArB,CAApB;AAGAF,IAAAA,OAAO,CAACC,GAAR,CAAYO,KAAZ;;AACA,QAAIA,KAAJ,EAAW;AACTX,MAAAA,GAAG,CAACgB,IAAJ,CAASL,KAAT;AACD,KAFD,MAEO;AACLX,MAAAA,GAAG,CAACgB,IAAJ,CAAS,EAAT;AACD;AACF,GAXD,MAWO;AACLhB,IAAAA,GAAG,CAACgB,IAAJ,CAAS,EAAT;AACD;AACF,CAnBD","sourcesContent":["import jwt from 'jsonwebtoken'\nimport { PrismaClient } from \"@prisma/client\"\nconst prisma = new PrismaClient()\n\nexport default async (req, res) => {\n  const { token } = req.cookies\n\n  console.log({token})\n\n  if (token ) {\n    const { id, setName } = jwt.verify(token, process.env.JWT_SECRET)\n    const songs = await prisma.song.findMany({\n      where: { setId: id }\n    })\n    console.log(songs)\n    if (songs) {\n      res.json(songs)\n    } else {\n      res.json({})\n    }\n  } else {\n    res.json({})\n  }\n}\n"]},"metadata":{},"sourceType":"module"}