{"ast":null,"code":"import { PrismaClient } from \"@prisma/client\";\nimport jwt from 'jsonwebtoken';\nexport default (async (req, res) => {\n  const prisma = new PrismaClient();\n  const {\n    token\n  } = req.cookies;\n\n  if (token) {\n    const {\n      _id,\n      setName\n    } = jwt.verify(token, process.env.JWT_SECRET);\n    const {\n      title,\n      artist\n    } = req.body;\n    const song = await prisma.song.create({\n      data: {\n        title,\n        artist,\n        Set: {\n          connect: {\n            setName\n          }\n        }\n      }\n    });\n    res.json(song);\n  } else {\n    res.json({\n      error: \"You must be signed in to add a song\"\n    });\n  }\n});","map":{"version":3,"sources":["/Users/elie/code/ehymowitz/set-sharer/pages/api/song/create.ts"],"names":["PrismaClient","jwt","req","res","prisma","token","cookies","_id","setName","verify","process","env","JWT_SECRET","title","artist","body","song","create","data","Set","connect","json","error"],"mappings":"AAAA,SAASA,YAAT,QAA6B,gBAA7B;AACA,OAAOC,GAAP,MAAgB,cAAhB;AAEA,gBAAe,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AACjC,QAAMC,MAAM,GAAG,IAAIJ,YAAJ,EAAf;AACA,QAAM;AAAEK,IAAAA;AAAF,MAAYH,GAAG,CAACI,OAAtB;;AAEA,MAAID,KAAJ,EAAW;AACT,UAAM;AAAEE,MAAAA,GAAF;AAAOC,MAAAA;AAAP,QAAmBP,GAAG,CAACQ,MAAJ,CAAWJ,KAAX,EAAkBK,OAAO,CAACC,GAAR,CAAYC,UAA9B,CAAzB;AACA,UAAM;AAAEC,MAAAA,KAAF;AAASC,MAAAA;AAAT,QAAoBZ,GAAG,CAACa,IAA9B;AACA,UAAMC,IAAI,GAAG,MAAMZ,MAAM,CAACY,IAAP,CAAYC,MAAZ,CAAmB;AACpCC,MAAAA,IAAI,EAAE;AAAEL,QAAAA,KAAF;AAASC,QAAAA,MAAT;AAAiBK,QAAAA,GAAG,EAAE;AAAEC,UAAAA,OAAO,EAAE;AAAEZ,YAAAA;AAAF;AAAX;AAAtB;AAD8B,KAAnB,CAAnB;AAGAL,IAAAA,GAAG,CAACkB,IAAJ,CAASL,IAAT;AACD,GAPD,MAOO;AACLb,IAAAA,GAAG,CAACkB,IAAJ,CAAS;AAAEC,MAAAA,KAAK,EAAE;AAAT,KAAT;AACD;AACF,CAdD","sourcesContent":["import { PrismaClient } from \"@prisma/client\"\nimport jwt from 'jsonwebtoken'\n\nexport default async (req, res) => {\n  const prisma = new PrismaClient()\n  const { token } = req.cookies\n\n  if (token) {\n    const { _id, setName } = jwt.verify(token, process.env.JWT_SECRET)\n    const { title, artist } = req.body\n    const song = await prisma.song.create({\n      data: { title, artist, Set: { connect: { setName } } },\n    })\n    res.json(song)\n  } else {\n    res.json({ error: \"You must be signed in to add a song\"})\n  }\n}\n"]},"metadata":{},"sourceType":"module"}